function startDropZone(){SetFileUpl("#pnVw");document.onpaste=function(n){var i=(n.clipboardData||n.originalEvent.clipboardData).items,t;for(index in i)t=i[index],t.kind==="file"&&dz.addFile(t.getAsFile())}}function SetFileUpl(n){$(n).each(function(){let n=$(this)[0].dropzone;n&&n.destroy()});$("#pnVw").removeClass("hide");$("#pnEd").addClass("hide");var t=!1;$(n).dropzone({url:"/filehandler/filesave",acceptedFiles:fts,parallelUploads:1,autoDiscover:!1,uploadMultiple:!0,autoProcessQueue:!0,previewsContainer:null,clickable:"#upfile",method:"post",dictDefaultMessage:"Drop file here to upload ",complete:function(n){$(".dz-preview").html("");$(".drop-pan").removeClass("spnloading");t||Success();n.previewElement.innerHTML=""},accept:function(n,i){let r=$("#flslist").val(),u=r.split("|");return $.each(u,function(r,u){if(u==n.name)return $("#errDet").html('<i class="fa fa-exclamation-triangle"><\/i> Error File already uploaded'),$(".dz-preview").html(""),showErr(),t=!0,i("This file is not accepted!")}),r!=""&&(r=r+"|"),r=r+n.name,$("#flslist").val(r),i()},init:function(){this.on("addedfile",function(){closeErr("#cmserrpn");t=!1;$(".drop-pan").addClass("spnloading")});this.on("completemultiple",function(){});this.on("queuecomplete",function(){var n=$("#fld").val();this.files[1]!=null&&this.removeFile(this.files);t||loadFls([n]);$(".dz-preview").html("")});this.on("sending",function(n,t,i){var r=$("#ticketId").val();i.append("ticketId",r)});this.on("success",function(n,t){let i=t.filename,r=n.name;if(i!=r){let i=$("#flslist").val(),r=i.replace(n.name,t.filename);$("#flslist").val(r)}});this.on("error",function(n,i){i.errorVw!=null?$("#errDet").html(i.errorVw):$("#errDet").html('<i class="fa fa-exclamation-triangle"><\/i>Error File Upload Failed - '+i);$(".dz-preview").html("");showErr();t=!0});dz=this}})}function loadFls(){loadjsn("/filehandler/filelist",showFiles)}function showFiles(n){let r=0,t="",i="";n.files.length>0&&$.each(n.files,function(n,u){i!=""&&(i=i+"|");i=i+u.Name;t=r>0?t+'<div class="row rw-pnc"  onclick="delAttach(\''+u.Name+"');\" >":t+'<div class="row rw-pn"  onclick="delAttach(\''+u.Name+"');\" >";t=t+'<div class="col-sm-1"><i class="ti-file"><\/i> <\/div>';t=t+'<div class="col-sm-9">'+u.Name+"<\/div>";t=t+'<div class="col-sm-1"><i class="ti-trash"><\/i> <\/div>';t=t+"<\/div>";r++});$("#flslist").val(i);$("#fls").html(t)}function delAttach(n){$.confirm({title:'<i class="fas fa-exclamation-triangle red"><\/i> Delete File ',content:"Confirm to Remove this File.",buttons:{confirm:function(){let i=$("#flslist").val(),t="",r=i.split("|");$.each(r,function(i,r){n!=r&&(t!=""&&(t=t+"|"),t=t+r)});$("#rmfile").val(n);loadjsn("/filehandler/rm",silent);$("#flslist").val(t);loadFls()},cancel:function(){}}})}$(document).ready(function(){});var fts=".jpg,.png,.js,.css,.gif,.txt,.text,.yml,.yaml,.html,.cshtml,.svg,.pdf,.json,.svg,.jfif,.xml,.xsd,.zip,.xsd,.jpeg,.docx,.xls,.rar,.log",dz;